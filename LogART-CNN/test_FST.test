#!/bin/bash
#SBATCH --job-name=logart
#SBATCH --time=48:00:00
#SBATCH --cpus-per-task=8
#SBATCH --gres=gpu:1
#SBATCH --mem=80G
#SBATCH --output=logart.txt
#SBATCH --partition=gbunchQ3

nvidia-smi
conda list

# FST: /home/user/jiaweixu/lijie/dataset/imageNet
# DGX: /data/jiaweixu/lijie/dataset/imageNet

# 定义要测试的 weight 值
weights=(10000)
iters_w=(20000)

# 循环遍历 weight 值并执行实验
for weight in "${weights[@]}"; do
  for iterw in "${iters_w[@]}"; do
    python main.py --data_path /home/user/jiaweixu/lijie/dataset/imageNet --arch mobilenetv2 --n_bits_w 4 --iters_w "$iterw" --scale_method dynamic --search_method tensor_wise --channel_wise --test_before_calibration --weight "$weight" > main.log 2>&1
    echo "Running one experiment finish..."
  done
done

# for weight in "${weights[@]}"; do
#   for iterw in "${iters_w[@]}"; do
#     python search_mobilenet.py --n_bits_w 4 --iters_w "$iterw" --scale_method dynamic --search_method layer_wise --weight "$weight" > main51.log 2>&1
#     echo "Running one experiment finish..."
#   done
# done

# for weight in "${weights[@]}"; do
#   for iterw in "${iters_w[@]}"; do
#     python search_mobilenet.py --n_bits_w 4 --iters_w "$iterw" --scale_method dynamic --search_method block_wise --weight "$weight" 
#     echo "Running one experiment finish..."
#   done
# done

# for weight in "${weights[@]}"; do
#   for iterw in "${iters_w[@]}"; do
#     python search_mobilenet.py --n_bits_w 4 --iters_w "$iterw" --scale_method dynamic --channel_wise --search_method tensor_wise --weight "$weight" > main51.log 2>&1
#     echo "Running one experiment finish..."
#   done
# done

# for weight in "${weights[@]}"; do
#   for iterw in "${iters_w[@]}"; do
#     python search_mobilenet.py --n_bits_w 4 --iters_w "$iterw" --scale_method dynamic --channel_wise --search_method layer_wise --weight "$weight" 
#     echo "Running one experiment finish..."
#   done
# done

# for weight in "${weights[@]}"; do
#   for iterw in "${iters_w[@]}"; do
#     python search_mobilenet.py --n_bits_w 4 --iters_w "$iterw" --scale_method dynamic --channel_wise --search_method block_wise --weight "$weight" 
#     echo "Running one experiment finish..."
#   done
# done

nvidia-smi
wait